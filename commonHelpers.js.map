{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '45010101-f091bc02c96679130727c6b77';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 15;\n\nlet currentPage = 1;\nlet currentQuery = '';\n\nexport async function fetchImages() {\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: API_KEY,\n        q: currentQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: currentPage,\n        per_page: PER_PAGE,\n      },\n    });\n\n    const images = response.data.hits;\n    const totalHits = response.data.totalHits;\n\n    return { images, totalHits };\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n\nexport function resetPage() {\n  currentPage = 1;\n}\n\nexport function incrementPage() {\n  currentPage += 1;\n}\n\nexport function setQuery(query) {\n  currentQuery = query;\n}\n\nexport function getCurrentPage() {\n  return currentPage;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport function renderImages(images) {\n  const gallery = document.querySelector('.gallery');\n  const markup = images\n    .map(\n      image => `\n    <li class=\"gallery-item\">\n      <a class=\"gallery-link\" href=\"${image.largeImageURL}\" data-title=\"${image.tags}\">\n        <img \n          class=\"gallery-image\" \n          src=\"${image.webformatURL}\" \n          alt=\"${image.tags}\" \n        />\n        <div class=\"gallery-info\">\n          <p class=\"info-item\"><b>Likes</b>: ${image.likes}</p>\n          <p class=\"info-item\"><b>Views</b>: ${image.views}</p>\n          <p class=\"info-item\"><b>Comments</b>: ${image.comments}</p>\n          <p class=\"info-item\"><b>Downloads</b>: ${image.downloads}</p>\n        </div>\n      </a>\n    </li>\n      `\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nexport function showNoResultsMessage() {\n  iziToast.error({\n    title: 'Error',\n    message: 'Sorry, there are no images. Please try again!',\n  });\n}\n\nexport function showEndOfResultsMessage() {\n  iziToast.info({\n    title: 'Info',\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n}\n","import {\n  fetchImages,\n  setQuery,\n  resetPage,\n  incrementPage,\n  getCurrentPage,\n} from './js/pixabay-api';\nimport {\n  renderImages,\n  showNoResultsMessage,\n  showEndOfResultsMessage,\n} from './js/render-functions';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst PER_PAGE = 15;\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const form = document.querySelector('#search-form');\n  const input = document.querySelector('#search-input');\n  const gallery = document.querySelector('.gallery');\n  const loader = document.querySelector('.loader');\n  const loadMoreButton = document.querySelector('#load-more');\n\n  if (!form || !input || !gallery || !loadMoreButton) {\n    console.error(\n      'Form, input, gallery, or load more button element not found'\n    );\n    return;\n  }\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionsData: 'title',\n    captionDelay: 250,\n  });\n\n  let totalHits = 0;\n\n  form.addEventListener('submit', async event => {\n    event.preventDefault();\n    const query = input.value.trim();\n\n    if (query === '') {\n      iziToast.error({\n        title: 'Error',\n        message: \"Search query can't be empty!\",\n      });\n      return;\n    }\n\n    loader.style.display = 'block';\n    loadMoreButton.style.display = 'none';\n    setQuery(query);\n    resetPage();\n\n    try {\n      const { images, totalHits: newTotalHits } = await fetchImages();\n      totalHits = newTotalHits;\n      gallery.innerHTML = '';\n\n      if (images.length === 0) {\n        showNoResultsMessage();\n      } else {\n        renderImages(images);\n        lightbox.refresh();\n        loadMoreButton.style.display = totalHits > PER_PAGE ? 'block' : 'none';\n      }\n    } catch (error) {\n      console.error('Error fetching images:', error);\n      iziToast.error({\n        title: 'Error',\n        message: 'Failed to fetch images. Please try again later.',\n      });\n    } finally {\n      loader.style.display = 'none';\n    }\n  });\n\n  loadMoreButton.addEventListener('click', async () => {\n    loader.style.display = 'block';\n    incrementPage();\n\n    try {\n      const { images } = await fetchImages();\n      const currentPage = getCurrentPage();\n\n      if (images.length > 0) {\n        renderImages(images);\n        lightbox.refresh();\n        const totalLoadedImages = currentPage * PER_PAGE;\n\n        if (totalLoadedImages >= totalHits) {\n          loadMoreButton.style.display = 'none';\n          showEndOfResultsMessage();\n        }\n      } else {\n        loadMoreButton.style.display = 'none';\n        showEndOfResultsMessage();\n      }\n    } catch (error) {\n      console.error('Error fetching images:', error);\n      iziToast.error({\n        title: 'Error',\n        message: 'Failed to fetch more images. Please try again later.',\n      });\n    } finally {\n      loader.style.display = 'none';\n    }\n  });\n});\n"],"names":["API_KEY","BASE_URL","PER_PAGE","currentPage","currentQuery","fetchImages","response","axios","images","totalHits","error","resetPage","incrementPage","setQuery","query","getCurrentPage","renderImages","gallery","markup","image","showNoResultsMessage","iziToast","showEndOfResultsMessage","form","input","loader","loadMoreButton","lightbox","SimpleLightbox","event","newTotalHits"],"mappings":"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"}